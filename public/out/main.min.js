"use strict";(()=>{"use strict";function b(){const b=localStorage.getItem("_login");let c="";c=100>=window.innerWidth||800>=window.innerWidth?"":"true"===b?"Logged":1400>=window.innerWidth?"Login":"Login with Twitch",a.loginTxt.textContent=c}const a={loginTxt:document.querySelector(".nav-auth__text"),formEl:document.querySelector(".nav-form__post"),inputEl:document.querySelector(".nav-form__input"),loginBtn:document.querySelector(".nav-auth__link"),listEl:document.querySelector(".main__list"),spinEl:document.querySelector(".main__spin")};a.formEl.addEventListener("submit",b=>{b.preventDefault();const c=a.inputEl.value.trim();c?(async function(b){await fetch("/",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({track:b})}).then(a=>a.json()).then(b=>function(b){null!=b&&a.spinEl.classList.add("visually-hidden");const c=b.tracks.items;let d=a.listEl;d.innerHTML="",c.forEach(b=>{const c=document.createElement("li"),e=document.createElement("span"),a=document.createElement("img"),f=document.createElement("a");e.classList.add("main__span"),c.classList.add("main__item"),a.classList.add("main__img"),f.classList.add("main__link"),a.src=b.album.images[1].url,a.alt=b.album.name,f.href=b.external_urls.spotify,f.target="_blank",f.rel="noopener noreferrer nofollow",f.textContent=`${b.name} - ${b.artists[0].name}`,e.textContent="click",d.appendChild(c),f.appendChild(e),c.appendChild(a),c.appendChild(f)})}(b)).catch(a=>console.error(a))}(c),a.spinEl.classList.remove("visually-hidden"),a.inputEl.placeholder="Type to search..."):(a.inputEl.placeholder="[error]",console.error("[error]")),a.formEl.reset()}),a.loginBtn.addEventListener("click",function(){const a=window.open("/auth/twitch"),c=setInterval(()=>{if(a.closed)clearInterval(c);else try{if(a.location.href.includes("/auth/twitch/callback")){const c=new URL(a.location.href).searchParams.get("code");a.close(),async function(c){try{const d=await fetch(`/auth/twitch/callback?code=${c}`,{method:"GET",headers:{"Content-type":"application/json"}}),{login:e,code:f}=await d.json();e&&(localStorage.setItem("_code",f),localStorage.setItem("_login",e),b())}catch(a){console.error(a)}}(c)}}catch(a){console.error(a)}},1e3)}),window.addEventListener("load",b),window.addEventListener("resize",b)})();