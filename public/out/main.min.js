"use strict";!function(){"use strict";function a(){const a=localStorage.getItem("_login");let b="";b=100>=window.innerWidth||800>=window.innerWidth?"":"true"===a?"Logged":1400>=window.innerWidth?"Login":"Login with Twitch",refs.loginTxt.textContent=b}const b={loginTxt:document.querySelector(".nav-auth__text"),formEl:document.querySelector(".nav-form__post"),inputEl:document.querySelector(".nav-form__input"),loginBtn:document.querySelector(".nav-auth__link"),listEl:document.querySelector(".main__list"),spinEl:document.querySelector(".main__spin")};b.formEl.addEventListener("submit",a=>{a.preventDefault();const c=b.inputEl.value.trim();c?(async function(a){await fetch("/",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({track:a})}).then(a=>a.json()).then(a=>function(a){null!=a&&b.spinEl.classList.add("visually-hidden");const c=a.tracks.items;let d=b.listEl;d.innerHTML="",c.forEach(b=>{const c=document.createElement("li"),e=document.createElement("span"),f=document.createElement("img"),a=document.createElement("a");e.classList.add("main__span"),c.classList.add("main__item"),f.classList.add("main__img"),a.classList.add("main__link"),f.src=b.album.images[1].url,f.alt=b.album.name,a.href=b.external_urls.spotify,a.target="_blank",a.rel="noopener noreferrer nofollow",a.textContent="".concat(b.name," - ").concat(b.artists[0].name),e.textContent="click",d.appendChild(c),a.appendChild(e),c.appendChild(f),c.appendChild(a)})}(a)).catch(a=>console.error(a))}(c),b.spinEl.classList.remove("visually-hidden"),b.inputEl.placeholder="Type to search..."):(b.inputEl.placeholder="[error]",console.error("[error]")),b.formEl.reset()}),b.loginBtn.addEventListener("click",function(){const b=window.open("/auth/twitch"),c=setInterval(()=>{if(b.closed)clearInterval(c);else try{if(b.location.href.includes("/auth/twitch/callback")){const c=new URL(b.location.href).searchParams.get("code");b.close(),async function(b){try{const c=await fetch("/auth/twitch/callback?code=".concat(b),{method:"GET",headers:{"Content-type":"application/json"}}),{login:d,code:e}=await c.json();d&&(localStorage.setItem("_code",e),localStorage.setItem("_login",d),a())}catch(a){console.error(a)}}(c)}}catch(a){console.error(a)}},1e3)}),window.addEventListener("load",a),window.addEventListener("resize",a)}();