"use strict";

!function () {
  "use strict";

  const e = {
    formEl: document.querySelector(".nav-form__post"),
    inputEl: document.querySelector(".nav-form__input"),
    loginBtn: document.querySelector(".nav-auth__link"),
    listEl: document.querySelector(".main__list"),
    spinEl: document.querySelector(".spin")
  };
  console.clear(), e.formEl.addEventListener("submit", t => {
    t.preventDefault();
    const n = e.inputEl.value.trim();
    localStorage.setItem("_input", n), localStorage.getItem("_input"), n ? (async function (t) {
      await fetch("/", {
        method: "POST",
        headers: {
          "Content-type": "application/json"
        },
        body: JSON.stringify({
          track: t
        })
      }).then(e => e.json()).then(t => function (t) {
        null != t && e.spinEl.classList.add("visually-hidden");
        const n = t.tracks.items;
        let l = e.listEl;
        l.innerHTML = "", n.forEach((e, t) => {
          const n = document.createElement("li"),
            a = document.createElement("span"),
            o = document.createElement("img"),
            i = document.createElement("a");
          a.classList.add("main__span"), n.classList.add("main__item"), o.classList.add("main__img"), i.classList.add("main__link"), o.src = e.album.images[1].url, o.alt = e.album.name, i.href = e.external_urls.spotify, i.target = "_blank", i.rel = "noopener noreferrer nofollow", i.textContent = "".concat(e.name, " - ").concat(e.artists[0].name), a.textContent = "click", l.appendChild(n), i.appendChild(a), n.appendChild(o), n.appendChild(i);
        });
      }(t)).catch(e => console.error(e));
    }(n), e.spinEl.classList.remove("visually-hidden"), e.inputEl.placeholder = "Type to search...") : (e.inputEl.placeholder = "[error]", console.error("[error]")), e.formEl.reset();
  }), e.loginBtn.addEventListener("click", () => {
    window.open("/auth/twitch");
  });
}();